## Project

Configuration related to the project in general.

##### `src`

- Type: string
- Default: src
- Environment: `FOUNDRY_SRC` or `DAPP_SRC`

The path to the contract sources relative to the root of the project.

##### `test`

- Type: string
- Default: test
- Environment: `FOUNDRY_TEST` or `DAPP_TEST`

The path to the test contract sources relative to the root of the project.

##### `script`

- Type: string
- Default: script
- Environment: `FOUNDRY_SCRIPT` or `DAPP_SCRIPT`

The path to the script contract sources relative to the root of the project.

##### `out`

- Type: string
- Default: out
- Environment: `FOUNDRY_OUT` or `DAPP_OUT`

The path to put contract artifacts in, relative to the root of the project.

##### `libs`

- Type: array of strings (paths)
- Default: lib
- Environment: `FOUNDRY_LIBS` or `DAPP_LIBS`

An array of paths that contain libraries, relative to the root of the project.

##### `cache`

- Type: boolean
- Default: true
- Environment: `FOUNDRY_CACHE` or `DAPP_CACHE`

Whether or not to enable caching. If enabled, the result of compiling sources, tests, and dependencies, are cached in `cache`.

##### `cache_path`

- Type: string
- Default: cache
- Environment: `FOUNDRY_CACHE_PATH` or `DAPP_CACHE_PATH`

The path to the cache, relative to the root of the project.

##### `broadcast`

- Type: string
- Default: broadcast

The path to the broadcast transaction logs, relative to the root of the project.

##### `force`

- Type: boolean
- Default: false
- Environment: `FOUNDRY_FORCE` or `DAPP_FORCE`

Whether or not to perform a clean build, discarding the cache.


### ZKsync Settings

Additional zksync settings can be defined on the profile of choice by specifying `profile.<name>.zksync` section.

For example to define the settings on `profile.default`:

```toml
[profile.default]
# ...Normal foundry settings...

[profile.default.zksync]
# ...ZKSync specific settings...
```

**zksolc vs solc Compiler Differences**

ZKsync uses the **zksolc** compiler, which has different configuration options compared to the standard Solidity compiler (**solc**). When configuring ZKsync projects:

- **zksolc-specific options**: Use the settings documented in this section (e.g., `optimizer_mode`, `fallback_oz`, `bytecode_hash`)
- **solc-specific options**: Standard Foundry optimizer settings like `optimizer_details` are **not applicable** to zksolc compilation
- **Shared options**: Basic settings like `optimizer` (boolean) work for both compilers but may have different default behaviors

For comprehensive zksolc compiler options and detailed configuration reference, see the [zksolc Standard JSON documentation](https://matter-labs.github.io/era-compiler-solidity/latest/03-standard-json.html#input-json).

##### `compile`

- Type: boolean
- Default: false

Compile contracts for zkEVM.

##### `startup`

- Type: boolean
- Default: true (will only have effect if `compile = true`)

Requires `compile = true` to have an effect.   
Enable ZKsync context on startup. This applies to tests, scripts, and any other commands that need to switch immediately to zkEVM on startup.

##### `zksolc`

- Type: string
- Default: `<latest-version>`

The zksolc version to use for compilation.

##### `solc_path`

- Type: string
- Default: `<default-zksolc-solc>`

The `solc` path to use during `zksolc` compilation.

##### `bytecode_hash`

- Type: string
- Default: "none"
- Options: "none" | "ipfs"

The bytecode hash method for zksolc compiled bytecode metadata. Set to "none" to exclude metadata hash, or "ipfs" to include IPFS hash.

##### `enable_eravm_extensions`

- Type: boolean
- Default: false

Enable EraVM extensions (e.g. system-mode). This allows compilation of ZKsync-specific simulations.

##### `force_evmla`

- Type: boolean
- Default: false 

Force compilation via EVMLA instead of Yul codegen pipeline.

##### `avoid_contracts`

- Type: array of strings
- Default: []

List of glob patterns to avoid compiling with zksolc.

#### ZKsync Optimizer Settings

The following settings control zksolc-specific optimization behavior. These are different from standard Solidity compiler (solc) optimizer options.

##### `optimizer`

- Type: boolean
- Default: true 

Enable optimizer on zksolc.

##### `optimizer_mode`

- Type: string
- Default: '3'
- Options: '0' | '1' | '2' | '3' | 's' | 'z'

The zksolc optimizer mode. Each mode represents different optimization strategies:
- '0': No optimization
- '1': Basic optimization
- '2': Advanced optimization  
- '3': Aggressive optimization (default)
- 's': Optimize for size
- 'z': Optimize for size with fallback (used internally by `fallback_oz`)

##### `fallback_oz`

- Type: boolean
- Default: false 

Enable size fallback optimization (corresponds to zksolc's `sizeFallback` setting). When enabled, if contracts exceed EraVM bytecode size limitations, the compiler will automatically recompile using `optimizer_mode = 'z'` to reduce bytecode size.

##### `optimizer_details`

- Type: object
- Default: {}

**⚠️ zksolc Compatibility Note**: This option is specific to the standard Solidity compiler (solc) and is **not used by zksolc**. 

zksolc uses a fundamentally different optimization approach compared to solc:

**For zksolc compilation**, use these zksolc-specific optimizer settings:
- `optimizer_mode`: Controls zksolc optimization level ('0' | '1' | '2' | '3' | 's' | 'z')
- `fallback_oz`: Enables automatic size fallback optimization (corresponds to zksolc's `sizeFallback`)

**For standard EVM compilation** (when `zksync.compile = false`), the standard `optimizer_details` settings apply.

**Choosing the Right Optimizer Settings**

- **ZKsync projects**: Configure `optimizer_mode` and `fallback_oz` in the `[profile.default.zksync]` section
- **Standard EVM projects**: Configure `optimizer_details` in the main profile section
- **Hybrid projects**: You can use both - zksolc settings for ZKsync compilation and solc settings for standard EVM compilation

**Configuration Examples:**

ZKsync-only project:
```toml
[profile.default.zksync]
compile = true
optimizer_mode = "3"
fallback_oz = true
bytecode_hash = "ipfs"
```

Hybrid project (both EVM and ZKsync):
```toml
[profile.default]
optimizer = true
optimizer_runs = 200

[profile.default.zksync]
compile = true
optimizer_mode = "3"
fallback_oz = true
```

For comprehensive zksolc compiler options and detailed configuration reference, see the [zksolc Standard JSON documentation](https://matter-labs.github.io/era-compiler-solidity/latest/03-standard-json.html#input-json).